<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
    integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
    crossorigin=""></script>
  <script src="speed.data.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/leaflet-extras/leaflet.sprite@gh-pages/dist/leaflet.sprite.js"></script>
</head>

<body>
  <div id="view_map" style="height: 500px;"></div>
  <script type="text/javascript">
    //緯度,経度,ズーム
    var map = L.map('view_map').setView([36.7105552, 137.2012866], 12);
    // OpenStreetMap から地図画像を読み込む
    L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
      maxZoom: 18,
      attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, '
    }).addTo(map);

    var popup = L.popup();
    for (const s of speeds) {
      const speed = s[2]
      let color
      if (speed <= 0) {
        color = '#bdbdbd'
      } else if (speed > 100) {
        color = '#e30000'
      } else if (speed > 40) {
        color = '#20bf00'
      } else if (speed > 20) {
        color = '#7fd61c'
      } else if (speed > 10) {
        color = '#1caed6'
      } else if (speed > 5) {
        color = '#d67f1c'
      } else {
        color = '#ed5818'
      }
      var popup = L.popup();
      L.circle([s[0], s[1]], { color, fillOpacity: 1, radius: 100 }).addTo(map).on('click', function (e) {
        popup
          .setLatLng(e.latlng)
          .setContent(`${speed} ${speed < 100 ? 'Mbps' : 'kbps'}`)
          .openOn(map);
      });
    }

  </script>
</body>

</html>